# Grezwanderer 4

**Grezwanderer 4** ‚Äî —ç—Ç–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∏–≥—Ä–æ–≤–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞, —Å—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ **Detective Mode**. –ü—Ä–æ–µ–∫—Ç –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤ —Å–µ–±–µ Visual Novel –∏ –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –≤ —É–Ω–∏–∫–∞–ª—å–Ω–æ–º –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–º —Å–µ—Ç—Ç–∏–Ω–≥–µ.

[üìú –ñ—É—Ä–Ω–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π (Changelog)](./update.md) | [üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](./ARCHITECTURE.md) | [‚öñÔ∏è –†–µ–≥–ª–∞–º–µ–Ω—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏](./DOCS_POLICY.md)

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ (Features)

### üïµÔ∏è Detective Investigation Engine
- **Unified Map System**: –ï–¥–∏–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–æ—á–µ–∫ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Å–ª–æ–∂–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ (Bindings DSL).
- **Narrative Threads**: –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ª–æ–≥–∏—á–µ—Å–∫–∏—Ö —Å–≤—è–∑–µ–π –º–µ–∂–¥—É —É–ª–∏–∫–∞–º–∏ –ø—Ä—è–º–æ –Ω–∞ –∫–∞—Ä—Ç–µ.
- **Infrastructure Navigation**: –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞ —Å —É—á–µ—Ç–æ–º –≥–æ—Ä–æ–¥—Å–∫–æ–π —Å—Ä–µ–¥—ã (–¥–æ—Ä–æ–≥–∏, –º–æ—Å—Ç—ã).

### üìÅ Dossier & Evidence
- **–ñ—É—Ä–Ω–∞–ª —É–ª–∏–∫**: –°–±–æ—Ä –∏ —Å–∏—Å—Ç–µ–º–∞—Ç–∏–∑–∞—Ü–∏—è –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤.
- **–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –ü–∞—Ä–ª–∞–º–µ–Ω—Ç**: –°–∏—Å—Ç–µ–º–∞ –∏–∑ 18 –≥–æ–ª–æ—Å–æ–≤-—Å—É–±–ª–∏—á–Ω–æ—Å—Ç–µ–π (–õ–æ–≥–∏–∫–∞, –≠–º–ø–∞—Ç–∏—è, –û–∫–∫—É–ª—å—Ç–∏–∑–º –∏ –¥—Ä.), –¥–∞—é—â–∏—Ö —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏ –∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É—é—â–∏—Ö –¥–µ–π—Å—Ç–≤–∏—è.
- **Progress Tracking**: –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–æ–≤—ã—Ö —Ç–æ—á–µ–∫ –∏–Ω—Ç–µ—Ä–µ—Å–∞ –ø–æ –º–µ—Ä–µ –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏—è –≤ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏.
- **Persistent State**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –∏ —É—Ä–æ–≤–Ω–µ–π –Ω–∞–≤—ã–∫–æ–≤ –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏.

### üåç Advanced Mapping
- **Mapbox v8 Integration**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –¥–≤–∏–∂–∫–∞ –¥–ª—è –ø–ª–∞–≤–Ω–æ–π –∏ –±—ã—Å—Ç—Ä–æ–π —Ä–∞–±–æ—Ç—ã —Å –∫–∞—Ä—Ç–æ–π.
- **Custom Styling**: –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å—Ç–∏–ª–µ–π (`inoti/cmktq...`) –¥–ª—è –∫–∞–∂–¥–æ–π –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–π —ç–ø–æ—Ö–∏.
- **Marker Animation**: –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–∞—Ä–∫–µ—Ä—ã –∏–≥—Ä–æ–∫–∞ –∏ NPC –¥–ª—è –∂–∏–≤–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–π.
- **Circular Map Pins**: –¢–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ "–∫—Ä—É–≥–ª—ã–µ" –º–µ—Ç–∫–∏ –ª–æ–∫–∞—Ü–∏–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∞—Ä—Ö–∏–≤–Ω—ã—Ö —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –∏ —Å–∏–º–≤–æ–ª–æ–≤ (—Å—É—Ä–≥—É—á, —á–µ—Ä–Ω–∏–ª–∞).

### üèó –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- **Unified Launch**: –ó–∞–ø—É—Å–∫ –≤—Å–µ–≥–æ —Å—Ç–µ–∫–∞ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π —á–µ—Ä–µ–∑ `bun run dev`.
- **E2E Typings**: –°–∫–≤–æ–∑–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è API –º–µ–∂–¥—É —Å–µ—Ä–≤–µ—Ä–æ–º –∏ –∫–ª–∏–µ–Ω—Ç–æ–º —á–µ—Ä–µ–∑ Eden Treaty.
- **Performance**: –°–≤–µ—Ä—Ö–±—ã—Å—Ç—Ä–∞—è —Å–±–æ—Ä–∫–∞ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –±–ª–∞–≥–æ–¥–∞—Ä—è Bun –∏ Vite 7.

---

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –°–∏—Å—Ç–µ–º—ã

–ü—Ä–æ–µ–∫—Ç —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω –∫–∞–∫ –º–æ–¥—É–ª—å–Ω—ã–π –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π, —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã–π –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –æ–±—â–∏–µ –ø–∞–∫–µ—Ç—ã.

### –û—Å–Ω–æ–≤–Ω–æ–π –°—Ç–µ–∫ (Tech Stack)
- **Runtime**: [Bun](https://bun.sh) (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–∫–µ—Ç–∞–º–∏, —Ç–µ—Å—Ç—ã, –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤)
- **Frontend**: React 19 + Vite 7 + Tailwind CSS v4
- **Backend**: ElysiaJS + Drizzle ORM + SQLite
- **Infrastructure**: Redis (Pub/Sub) + Clerk (Auth)

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –î–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
```text
.
‚îú‚îÄ‚îÄ apps/
‚îÇ   ‚îú‚îÄ‚îÄ web/                        # [Frontend] React + Vite + Tailwind 4
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ app/                # –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –∏ —Å—Ç–∏–ª–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ entities/           # –ë–∏–∑–Ω–µ—Å-—Å—É—â–Ω–æ—Å—Ç–∏ (State & Model)
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ inventory/      # –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –∏–≥—Ä–æ–∫–∞ (Zustand)
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ visual-novel/   # –î–≤–∏–∂–æ–∫ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –∏ UI –Ω–æ–≤–µ–ª–ª—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ features/           # –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ detective/      # –õ–æ–≥–∏–∫–∞ —Ä–µ–∂–∏–º–∞ –¥–µ—Ç–µ–∫—Ç–∏–≤–∞ (Hardlinks, Dossier)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pages/              # –°—Ç—Ä–∞–Ω–∏—Ü—ã (HomePage, QRScannerPage)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ shared/             # –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∫–æ–¥ (UI Kit, Libs)
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ widgets/            # –ö—Ä—É–ø–Ω—ã–µ –±–ª–æ–∫–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ map/            # Mapbox –æ–±–µ—Ä—Ç–∫–∏ (MapView, Layers)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.html
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ vite.config.ts
‚îÇ   ‚îî‚îÄ‚îÄ server/                     # [Backend] ElysiaJS + Bun
‚îÇ       ‚îú‚îÄ‚îÄ src/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ config/             # Env vars (Redis, Clerk, Mapbox)
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ db/                 # Drizzle Schemas & Migrations (SQLite)
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ middleware/         # Auth (Clerk) & Logging
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ modules/            # API Endpoints (Map, Quests)
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ services/           # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (Ranking, Geo)
‚îÇ       ‚îî‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ packages/                       # [Shared Workspace]
‚îÇ   ‚îî‚îÄ‚îÄ shared/
‚îÇ       ‚îú‚îÄ‚îÄ data/                   # JSON-–∫–æ–Ω—Ñ–∏–≥–∏ –∏ –∞—Å—Å–µ—Ç—ã
‚îÇ       ‚îú‚îÄ‚îÄ locales/                # i18n —Å–ª–æ–≤–∞—Ä–∏
‚îÇ       ‚îî‚îÄ‚îÄ lib/                    # Shared Types & Utils
‚îú‚îÄ‚îÄ .env                            # Secrets (Git Ignored)
‚îî‚îÄ‚îÄ package.json                    # Root Config (Workspaces)
```

---

## ÔøΩ –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
–î–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–æ–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `concurrently`. –í—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å—ë –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π –∏–∑ –∫–æ—Ä–Ω—è:

```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
bun install

# 2. –ó–∞–ø—É—Å–∫ –≤—Å–µ–≥–æ —Å—Ç–µ–∫–∞ (Web + Server –≤ –ø–∞—Ä–∞–ª–ª–µ–ª–∏)
bun run dev

# 3. –°–±–æ—Ä–∫–∞ –≤—Å–µ—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤
bun run build
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)
Vite –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –∑–∞–≥—Ä—É–∑–∫—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–∑ –∫–æ—Ä–Ω—è –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è. –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫–ª—é—á–∏:
- `VITE_MAPBOX_TOKEN`: –¢–æ–∫–µ–Ω –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–∞—Ä—Ç.
- `VITE_CLERK_PUBLISHABLE_KEY`: –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.
- `CLERK_SECRET_KEY`: –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á —Å–µ—Ä–≤–µ—Ä–∞.
- `DATABASE_URL`: –°—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ.

---

## üó∫ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏–∏
–í –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è —Ä–∞–±–æ—Ç–∞ —Å –∫–∞—Ä—Ç–∞–º–∏ –Ω–∞ –±–∞–∑–µ **Mapbox v8**:
- **Custom Styles**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ–≥–æ —Å—Ç–∏–ª—è `mapbox://styles/inoti/cmktqmmks002s01pa3f3gfpll`.
- **Visual FX**: –ù–∞–ª–æ–∂–µ–Ω–∏–µ –≤–∏–Ω—Ç–∞–∂–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤ (sepia, contrast, brightness) –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏.
- **Dossier System**: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏–≥—Ä–æ–≤—ã—Ö —Ç–æ—á–µ–∫ –∏–Ω—Ç–µ—Ä–µ—Å–∞ —Å Dossier Store –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ —É–ª–∏–∫.

---
*Grezwanderer 4 ‚Äî –ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –∑–¥–µ—Å—å.*
